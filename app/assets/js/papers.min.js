!function(a,b,c){"use strict";function d(){var a=b.getItem("uid");return a||(a=Math.floor(1e8*Math.random()),b.setItem("uid",a)),a}function e(b,c,e){return"object"==typeof c&&(c.uid=d()),a.ajax(a.extend({type:"post",url:"/"+b+".json",data:c},e||{}))}function f(){b.setItem("cfp-votes",c.stringify(j))}function g(a){j[a]=1,f()}function h(a){j[a]=1,f()}function i(a){return!!j[a]}var j=c.parse(b.getItem("cfp-votes"))||{};a(function(){function b(){[].slice.call(document.querySelectorAll("tr.js-paper")).sort(function(a,b){return a=parseInt((a.querySelector("td:first-of-type .js-score")||{}).innerHTML),b=parseInt((b.querySelector("td:first-of-type .js-score")||{}).innerHTML),a>b?-1:b>a?1:0}).forEach(function(a){a.parentNode.appendChild(a)})}function c(){[].slice.call(document.querySelectorAll("tr.js-paper")).sort(function(a,b){return a=new Date((a.querySelector(".js-date")||{}).innerHTML).valueOf(),b=new Date((b.querySelector(".js-date")||{}).innerHTML).valueOf(),a>b?-1:b>a?1:0}).forEach(function(a){a.parentNode.appendChild(a)})}function d(a){return/favorited/i.test((a.querySelector(".js-favorite")||{}).className)?1:-1}function f(){[].slice.call(document.querySelectorAll("tr.js-paper")).sort(function(a,b){return a=d(a),b=d(b),a>b?-1:b>a?1:0}).forEach(function(a){a.parentNode.appendChild(a)})}function j(){var d=a(this).val()||"date";/date/i.test(d)?c():/pop|score/i.test(d)?b():/fav/i.test(d)&&f()}a("body").on("change",".js-sort-by",j),c(),a(".paper").each(function(){var b=a(this),c=b.attr("data-id"),d=b.find(".description .excerpt"),f=b.find(".description .fulldesc");b.find(".description .more").click(function(a){a.preventDefault(),d.hide(),f.slideDown(300)}),b.find(".description .less").click(function(a){a.preventDefault(),f.slideUp(300,function(){d.show()})});var j=b.find(".voteup"),k=j.find(".js-score");i(c)&&j.addClass("upvoted"),j.click(function(b){b.preventDefault();var d,f=a(this);f.hasClass("upvoted")?(d=-1,f.removeClass("upvoted"),h(c)):(d=1,f.addClass("upvoted"),g(c));var i=parseFloat(k.text())+d;k.fadeOut(400,function(){k.text(i).fadeIn(400)}),e("tally",{id:c,score:d})}),b.find(".favorite").click(function(b){b.preventDefault();var d=a(this),f=d.hasClass("favorited")?"0":"1";d.toggleClass("favorited"),e("admin-favorite",{id:c,onoff:f})}),b.find(".delete").click(function(a){a.preventDefault(),window.confirm("Are you sure you want to delete this submission?")&&(b.remove(),e("admin-delete",{id:c,state:0}))});var l=b.find(".comment-text");b.find(".comment").click(function(a){a.preventDefault();var b=window.prompt("Comment:",l.text());null!==b&&(l.text(b),e("admin-comment",{id:c,comment:b}))})})})}(jQuery,window.localStorage||{getItem:jQuery.noop,setItem:jQuery.noop},window.JSON||{stringify:jQuery.noop,parse:jQuery.noop});